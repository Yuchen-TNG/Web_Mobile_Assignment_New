@inject DB db

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"] - My App</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    <header>
        <h1><a href="/">ASP.NET Core Security</a></h1>

        @* User email and role *@
        @if (User.Identity!.IsAuthenticated)
        {
            <div>
                @User.Identity.Name |
                @(User.IsInRole("Admin") ? "Admin" : "")
                @(User.IsInRole("Owner") ? "Owner" : "")
                @(User.IsInRole("Tenant") ? "Tenant" : "")
            </div>
        }

        @* Member photo *@
        @if (User.IsInRole("Tenant"))
        {
            var photoURL = db.Tenants.Find(User.Identity!.Name)!.PhotoURL;
            <img src="/photos/@photoURL">
        }
        @if (User.IsInRole("Owner"))
        {
            var photoURL = db.Owners.Find(User.Identity!.Name)!.PhotoURL;
            <img src="/photos/@photoURL">
        }
    </header>

    <!-- 导航栏 (全局公用) -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary px-3">
        <a class="navbar-brand text-white" href="/">MySystem</a>

        <form class="d-flex mx-auto" style="width: 400px;">
            <input class="form-control me-2" type="search" placeholder="Search..." />
            <button class="btn btn-outline-light" type="submit">Search</button>
        </form>

        <div></div>

        @* Menu trimming *@
        @if (User.IsInRole("Tenant"))
        {
            <a href="/Home/Tenant">Tenant</a>
        }
        @if (User.IsInRole("Owner"))
        {
            <a href="/Home/Owner">Owner</a>
        }
        @if (User.IsInRole("Admin"))
        {
            <a href="/Home/Admin">Admin</a>
        }

        <div></div>
        @if (User.Identity!.IsAuthenticated)
        {
            <a href="/Account/Logout">Logout</a>
            <a href="/Account/UpdatePassword">Update Password</a>
        }
        else
        {
            <a href="/Account/Login" class="btn btn-outline-primary me-2">Login</a>
            <a href="/Account/Register" class="btn btn-light text-primary">Register</a>
            <a href="/Account/ResetPassword" class="btn btn-primary">Reset Password</a>
        }
        @if (User.IsInRole("Tenant") || User.IsInRole("Owner"))
        {
            <a href="/Account/UpdateProfile">Update Profile</a>
        }
    </nav>

    <!-- 页面内容 (每个页面都会插到这里) -->
    <div class="container mt-4">
        @RenderBody()
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.unobtrusive-ajax.min.js"></script>
    <script src="/js/jquery.validate.min.js"></script>
    <script src="/js/jquery.validate.unobtrusive.min.js"></script>
    <script src="/js/app.js" asp-append-version="true"></script>
    @RenderSection("foot", false)
</body>
</html>
